# Audiophile E-Commerce Setup Guide

## Convex Backend Setup

The project includes Convex database schemas and functions, but they need to be initialized:

### Option 1: Run Convex Locally (Development)

1. **Initialize Convex**:
   ```bash
   npx convex dev
   ```

2. When prompted:
   - Choose "Start without an account (run Convex locally)"
   - Enter project name: `audiophile-ecommerce`
   - Confirm to continue

3. Convex will:
   - Generate the `_generated` folder with TypeScript types
   - Start a local Convex development server
   - Auto-generate `NEXT_PUBLIC_CONVEX_URL` in `.env.local`

### Option 2: Deploy to Convex Cloud (Production)

1. **Login to Convex**:
   ```bash
   npx convex login
   ```

2. **Deploy**:
   ```bash
   npx convex deploy
   ```

3. Copy the deployment URL to `.env.local` as `NEXT_PUBLIC_CONVEX_URL`

## Email Configuration

To enable order confirmation emails:

1. **Copy environment variables**:
   ```bash
   cp .env.local.example .env.local
   ```

2. **Configure SMTP settings** in `.env.local`:

   ### For Gmail:
   ```env
   SMTP_HOST=smtp.gmail.com
   SMTP_PORT=587
   SMTP_USER=your_email@gmail.com
   SMTP_PASS=your_app_password
   ```

   **To get Gmail App Password**:
   - Enable 2FA on your Google account
   - Visit: https://myaccount.google.com/apppasswords
   - Generate a new app password
   - Use the 16-character password as `SMTP_PASS`

   ### For Other Email Providers:
   - **Outlook/Hotmail**: `smtp-mail.outlook.com` (Port 587)
   - **Yahoo**: `smtp.mail.yahoo.com` (Port 587)
   - **Custom SMTP**: Use your provider's settings

3. **Set App URL** (for local development):
   ```env
   NEXT_PUBLIC_APP_URL=http://localhost:3000
   ```

## Database Schema

The project includes the following Convex schemas:

### Products Table
- Product details (name, price, category, description)
- Images (product, category preview, gallery)
- Features and included items
- Product recommendations

### Orders Table
- Customer details (name, email, phone)
- Shipping address
- Payment method (e-money or cash-on-delivery)
- Order items with quantities
- Totals (subtotal, shipping, VAT, grand total)
- Order status and timestamp

## Complete Setup Steps

1. **Install dependencies**:
   ```bash
   npm install
   ```

2. **Initialize Convex** (choose one):
   ```bash
   # Local development
   npx convex dev
   
   # OR production deployment
   npx convex login && npx convex deploy
   ```

3. **Configure environment variables**:
   ```bash
   cp .env.local.example .env.local
   # Then edit .env.local with your SMTP credentials
   ```

4. **Run development server**:
   ```bash
   npm run dev
   ```

5. **Test the checkout flow**:
   - Add products to cart
   - Go to checkout
   - Fill in customer details
   - Submit order
   - Check email for confirmation
   - View order success page

## Features Implemented

✅ **Shopping Cart**: Add/remove items, adjust quantities, cart modal
✅ **Checkout Form**: Multi-step validation (billing, shipping, payment)
✅ **Order Processing**: Server-side order creation with unique order IDs
✅ **Email Confirmation**: HTML email template with order details
✅ **Success Page**: Order confirmation with order ID and summary
✅ **Database Ready**: Convex schemas for products and orders (ready to seed)

## Next Steps

1. **Seed Products**: Create a script to populate the products table with your product data
2. **Test Email**: Verify email delivery works with your SMTP settings
3. **Customize Email Template**: Update branding in `/src/app/api/send-email/route.ts`
4. **Add Order Tracking**: Create an order history page for customers
5. **Deploy**: Deploy to Vercel and configure production environment variables

## Troubleshooting

### Convex Errors
If you see TypeScript errors in `convex/` folder:
- Make sure `npx convex dev` is running
- Check that `_generated` folder exists
- Restart your editor/IDE

### Email Not Sending
- Verify SMTP credentials are correct
- Check spam folder
- Enable "Less secure app access" (Gmail) or use App Password
- Check firewall/port settings for SMTP port

### Order Not Saving
- Ensure Convex dev server is running
- Check browser console for errors
- Verify `NEXT_PUBLIC_CONVEX_URL` is set correctly

## Environment Variables

Required variables in `.env.local`:

```env
NEXT_PUBLIC_CONVEX_URL=        # Auto-generated by Convex
NEXT_PUBLIC_APP_URL=           # Your app URL (http://localhost:3000)
SMTP_HOST=                     # SMTP server
SMTP_PORT=                     # SMTP port (usually 587)
SMTP_USER=                     # Your email
SMTP_PASS=                     # App password
```
